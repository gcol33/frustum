# Frustum Feature Audit: 001–005

**Date:** 2026-01-17
**Status:** PASSED — Features 001–005 are internally consistent and ready for freeze.

---

## Audit Summary

| Check | Status | Notes |
|-------|--------|-------|
| 002 ↔ 005 Axes reconciliation | FIXED | 002 now defers to 005 for Axes definition |
| 001 ↔ 002 Scene.objects/AnyRenderable | OK | Properly deferred |
| 001 ↔ 002 world_bounds authority | FIXED | Added spatial semantics section to 001 |
| 001 ↔ 002 Transforms | FIXED | No transforms in v0.1 (world-space only) |
| 001 ↔ 004 Scene.materials | FIXED | Added `materials` field to Scene in 001 |
| 001 ↔ 005 Axes bounds | FIXED | Axes bounds must be subset of world_bounds |
| 002 ↔ 003 Mesh output | FIXED | Added material assignment note to 003 |
| 002 ↔ 004 material_id/scalars | OK | Validation rules aligned |
| 004 ↔ 005 Materials/Axes | FIXED | Axes require SolidMaterial, no special-casing |
| Terminology consistency | FIXED | Standardized "vec3" across all features |

---

## Changes Made

### 001-scene-camera.md
- Added `materials: list[Material]` to Scene required fields
- Added constraint: "A scene with no materials is valid (but objects cannot render without materials)"
- Updated Note to reference Feature 004 for Material definition
- Clarified scope: "axes definition (deferred to Feature 005; axes may exist in `objects`)"
- Terminology: "3D vector" → "vec3" for consistency
- Added **Spatial semantics** section:
  - `world_bounds` is authoritative for all geometry
  - All geometry in world coordinates prior to camera projection
  - No per-object transforms in v0.1 (world-space only)
- Added **Mutability** section:
  - Objects immutable after Scene validation
  - Scene updates require new Scene construction

### 002-geometry-primitives.md
- Added **Appearance rule (frozen)**: geometry must not define visual appearance
- Replaced `color` with `material_id` on all primitives (Points, Lines, Curves, Meshes)
- Added `material_id` to Axes optional fields
- Replaced Axes full definition with deferral to Feature 005
- Updated validation rules: material reference checks instead of color/scalar mutual exclusivity

### 003-marching-cubes.md
- Added note: "The output Mesh has no `material_id`. The user must assign a material before the mesh can be rendered."

### 004-materials-color.md
- Added **No implicit materials (frozen)** rule in core design principles

### 005-axes.md
- Added authoritative statement: "This feature is the authoritative definition of the Axes primitive referenced in Feature 002."
- Clarified bounds relationship: "typically matches `Scene.world_bounds`"
- Added validation rule: Axes bounds must be subset of `Scene.world_bounds`
- Moved `material_id` to required fields
- Added **Material rule (frozen)**: Axes require material, no implicit colors, ticks/labels inherit
- Added validation rule: ScalarMappedMaterial not allowed for axes (SolidMaterial only)
- Added **Renderer contract** section: Axes expand to Lines, no special-casing

---

## Feature Dependency Graph

```
001 Scene/Camera
 ├── 002 Geometry Primitives (AnyRenderable)
 │    └── 005 Axes (authoritative definition)
 ├── 004 Materials (Material)
 └── 003 Marching Cubes (produces Mesh → 002)
```

---

## Frozen Decisions

1. **Primitive rule**: If it can be expressed as a combination of existing primitives, it is not a new primitive.

2. **Appearance rule**: Geometry primitives must not define visual appearance directly. All appearance via material references.

3. **No implicit materials**: SolidMaterial is canonical for uniform color. No auto-generation.

4. **Coordinate system**: OpenGL convention (−Z forward, +Z toward viewer)

5. **Five primitives**: Points, Lines, Curves, Meshes, Axes (complete set for v0.1)

6. **World-space only**: No per-object transforms in v0.1. All geometry positions are world coordinates.

7. **world_bounds authority**: Scene.world_bounds is the authoritative spatial extent. All geometry must lie within.

8. **Immutability**: Objects and Scene are immutable after validation. Updates require new construction.

9. **Axes are geometry**: Axes require SolidMaterial, expand to Lines, no renderer special-casing.

10. **No scalar-mapped axes**: Axes may only reference SolidMaterial (ScalarMappedMaterial is a validation error).

---

## Ready for Next Phase

Features 001–005 define the complete semantic model:
- **Scene container** (001)
- **Geometric atoms** (002, 005)
- **Geometry generation** (003)
- **Appearance layer** (004)

Recommended next steps:
1. Feature 006: Lighting (minimal, Lambertian)
2. Feature 007: Rendering pipeline
3. Schema codification (TypeScript → JSON Schema)
